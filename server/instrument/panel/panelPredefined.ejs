<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

    <title>Panel - Champions of Guilds &amp; Strongholds</title>

    <link rel="stylesheet" href="<%= viewModel.baseurl %>/css/style.css?v=<%= viewModel.timestamp %>">
    <link rel="stylesheet" href="<%= viewModel.baseurl %>/css/ui.css?v=<%= viewModel.timestamp %>">
  </head>

  <body>
    <div class="card-brown">
      <h1>Champions of Guilds &amp; Strongholds - create game</h1>

      <div class="seperator-20"></div>

      <u>Select Map</u> |
      <a href="<%= viewModel.baseurl %>/editorMap/mapChoose">Map Editor</a> | 
      <a href="<%= viewModel.baseurl %>/editorLand/landChoose">Land Editor</a>


      <div class="seperator-20"></div>


      <form action="<%= viewModel.baseurl %>/panelPredefined/createGamePost" method="POST">
        <button type="submit">Create Game</button>
        <span> </span>
        <button type="submit" formaction="<%= viewModel.baseurl %>/panelPredefined/launchImmediately" formmethod="get">Launch Immediately</button>

        <div class="seperator-20"></div>

        <span>Predefined map:</span><br />
        <select name="mapId">
          <% viewModel.mapNameArray.forEach((mapId) => { %>
            <option value="<%= mapId %>"><%= mapId %></option>
          <% }); %>
        </select>
      </form>

      <div class="seperator-10"></div>
      <hr />
      <div class="seperator-10"></div>

      <h2>Game instances</h2>

      <div class="seperator-10"></div>
      <hr />
      <div class="seperator-10"></div>

      <div>

        <% viewModel.games.forEach((game) => { %>
          <div class="inline-block">
            <div>ID: <%= game._id %></div>
            <div>MAP: <%= game[game._id].mapData.name %></div>
            <% viewModel._.forEach(game, (entity) => { %>
              <% if (entity.playerToken && entity.playerData) { %>
                <div class="seperator-10"></div>
                <div><span>NAME: <%= entity.playerData.name %></span></div>
                <% const uri = '/game?gameId=' + game._id + '&playerToken=' + entity.playerToken; %>
                <div><a href="<%= viewModel.baseurl + uri %>">Open Map</a></div>
              <% } %>
            <% }); %>
            <div class="seperator-10"></div>
            <div>
              <form class="inline-block" action="/panelPredefined/deleteGamePredefinedPost" method="post">
                <input name="gameId" type="hidden" value="<%= game._id %>">
                <button type="submit">Delete</button>
              </form>
            </div>
          </div>

          <div class="seperator-10"></div>
          <hr />
          <div class="seperator-10"></div>
        <% }); %>

      </div>
    </div>

    <div style="display: none;">
       <img src="<%= viewModel.baseurl %>/image/ui/border-image-button-down.png">
    </div>
  </body>
</html>
