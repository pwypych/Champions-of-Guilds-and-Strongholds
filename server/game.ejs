<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" />

    <title>Game - Champions of Guilds &amp; Strongholds</title>

    <link rel="stylesheet" href="<%= viewModel.baseurl %>/css/style.css?v=<%= viewModel.timestamp %>">
    <link rel="stylesheet" href="<%= viewModel.baseurl %>/css/ui.css?v=<%= viewModel.timestamp %>">

    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/jquery-3.3.1.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/url-2.5.3.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/lodash-4.17.10.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/pixi-4.8.2.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/pixi-viewport-3.4.1.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/pixi-simple-insertion-sort.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/tweenmax-2.0.2.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/timelinemax-2.0.2.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/pathfinding-browser-0.4.18.js"></script>
    <script type="text/javascript" src="<%= viewModel.baseurl %>/library/seedrandom-3.0.1.js"></script>
  </head>

  <body>
    <!-- Load all .ejs modules converted to html earlier -->
    <% viewModel.htmlArray.forEach((html) => { %>
      <%- html %>
    <% }); %>

    <!-- Main Pixi Canvas -->
    <div data-canvas-wrapper style="display: none;"></div>

    <script>
      'use strict';

      // Define a global variable g, for game libraries
      const g = {};

      g.autoload = {};
      g.setup = {};
      g.setup.blueprint = <%- viewModel.blueprint %>;
      g.setup.spriteFilenameArray = <%- viewModel.spriteFilenameArray %>;

      // Starting module is will be loaded in g.main object
      // Every other client module is in g.autoload object
      // All modules are in bundle.js file
    </script>

    <script type="text/javascript" src="<%= viewModel.baseurl %>/build/bundle.js?v=<%= viewModel.timestamp %>"></script>

    <script>
      // Game code starts with g.main() function
      window.onload = () => {
        g.main();
      }
    </script>

  </body>
</html>
